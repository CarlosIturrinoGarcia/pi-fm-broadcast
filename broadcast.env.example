# Pi FM Broadcast Configuration Example
# Copy this file to broadcast.env and fill in your values
# IMPORTANT: Never commit broadcast.env to version control!

# ============================================================
# AWS Configuration (REQUIRED)
# ============================================================

# SQS Queue URL (REQUIRED)
export QUEUE_URL="https://sqs.us-east-1.amazonaws.com/YOUR_ACCOUNT_ID/your-queue-name.fifo"

# AWS Region
export AWS_REGION="us-east-1"

# Dead Letter Queue URL (optional but recommended)
export DLQ_URL="https://sqs.us-east-1.amazonaws.com/YOUR_ACCOUNT_ID/your-dlq-name.fifo"

# ============================================================
# Broadcast Configuration
# ============================================================

# Broadcast command template
# {file} will be replaced with the actual WAV file path
# Examples:
#   - For pifm: "/usr/bin/sudo /usr/local/bin/pifm {file} -f 91.5"
#   - For testing: "aplay -q {file}"
export BROADCAST_CMD="/usr/bin/sudo /usr/local/bin/pifm {file} -f 91.5"

# ============================================================
# Timeouts and Limits (seconds)
# ============================================================

# SQS message visibility timeout (how long message is hidden after receiving)
export VISIBILITY=3600

# Heartbeat interval for extending visibility during playback
export HEARTBEAT_SEC=5

# Maximum playback duration (broadcasts longer than this will be killed)
export MAX_PLAYBACK_SECS=1800

# Total message processing timeout (download + playback)
export MESSAGE_TIMEOUT_SECS=2400

# Maximum receive count before sending to DLQ
export MAX_RECEIVE_COUNT=5

# SQS long polling wait time
export SQS_WAIT_TIME=20

# ============================================================
# File Management
# ============================================================

# Directory for downloaded WAV files
export DOWNLOAD_DIR="/home/rpibroadcaster/wav"

# Maximum number of files to keep (0 = unlimited, not recommended)
export MAX_STORED_FILES=100

# File cleanup interval (seconds)
export CLEANUP_INTERVAL=300

# ============================================================
# Silence Carrier Configuration
# ============================================================

# Path to silence WAV file (will be created if it doesn't exist)
export SILENCE_FILE="/home/rpibroadcaster/wav/silence_carrier.wav"

# Duration of silence carrier in seconds
export SILENCE_SECS=1800

# ============================================================
# Security (Optional Whitelists)
# ============================================================

# Allowed S3 buckets (comma-separated, empty = allow all)
# Recommended: Set this to only your trusted buckets
export ALLOWED_S3_BUCKETS="my-audio-bucket,my-backup-bucket"

# Allowed URL domains (comma-separated, empty = allow all)
# Recommended: Set this to only your trusted CDN domains
export ALLOWED_URL_DOMAINS="cdn.example.com,backup.example.com"

# ============================================================
# Logging (Optional)
# ============================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
export LOG_LEVEL="INFO"

# Use structured JSON logging (true/false)
export STRUCTURED_LOGGING="false"

# Dashboard Authentication (Optional but Recommended)
# ============================================================

# --- Option 1: Simple PIN Authentication (Touchscreen-Friendly) ---
# If set, users can log in using any username and this PIN as password
# export DASHBOARD_PIN="1234"

# --- Option 2: Username + Password Hash Authentication ---
# Username for dashboard login (default: admin)
# export DASHBOARD_USERNAME="admin"

# Password hash (SHA256) for dashboard login
# To generate a hash, run: echo -n "your_password" | sha256sum
# Example for password "admin": 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918
# export DASHBOARD_PASSWORD_HASH="8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918"

# NOTE: If neither DASHBOARD_PIN nor DASHBOARD_PASSWORD_HASH is set,
# the dashboard will use default credentials (admin/admin) for initial setup.
# This is NOT secure and should be changed in production!

# ============================================================
# TTS/Message Broadcasting Configuration (Optional)
# ============================================================

# TTS API endpoint for message broadcasting
# This endpoint receives text messages and converts them to audio for FM broadcast
# Example: "https://your-api-endpoint.com/tts"
export TTS_ENDPOINT="https://your-tts-api-endpoint.com/tts"

# S3 bucket for storing TTS-generated audio files
export TTS_S3_BUCKET="audio-txt-broadcast"

# S3 prefix (folder path) for TTS audio files
export TTS_S3_PREFIX="tts/"

# ============================================================
# TTS API Configuration (Optional)
# ============================================================

# AWS API Gateway endpoint for TTS service
export TTS_API_URL="https://your-api-id.execute-api.us-east-1.amazonaws.com/prod/tts"

# API key for authenticating with the TTS API Gateway
export TTS_API_KEY="your-api-key-here"

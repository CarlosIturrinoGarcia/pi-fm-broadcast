# Pi FM Broadcast Configuration Example
# Copy this file to broadcast.env and fill in your values
# IMPORTANT: Never commit broadcast.env to version control!

# ============================================================
# AWS Configuration (REQUIRED)
# ============================================================

# SQS Queue URL (REQUIRED)
export QUEUE_URL="https://sqs.us-east-1.amazonaws.com/YOUR_ACCOUNT_ID/your-queue-name.fifo"

# AWS Region
export AWS_REGION="us-east-1"

# Dead Letter Queue URL (optional but recommended)
export DLQ_URL="https://sqs.us-east-1.amazonaws.com/YOUR_ACCOUNT_ID/your-dlq-name.fifo"

# ============================================================
# Broadcast Configuration
# ============================================================

# Broadcast command template
# {file} will be replaced with the actual WAV file path
# Examples:
#   - For pifm: "/usr/bin/sudo /usr/local/bin/pifm {file} -f 91.5"
#   - For testing: "aplay -q {file}"
export BROADCAST_CMD="/usr/bin/sudo /usr/local/bin/pifm {file} -f 91.5"

# ============================================================
# Timeouts and Limits (seconds)
# ============================================================

# SQS message visibility timeout (how long message is hidden after receiving)
export VISIBILITY=3600

# Heartbeat interval for extending visibility during playback
export HEARTBEAT_SEC=5

# Maximum playback duration (broadcasts longer than this will be killed)
export MAX_PLAYBACK_SECS=1800

# Total message processing timeout (download + playback)
export MESSAGE_TIMEOUT_SECS=2400

# Maximum receive count before sending to DLQ
export MAX_RECEIVE_COUNT=5

# SQS long polling wait time
export SQS_WAIT_TIME=20

# ============================================================
# File Management
# ============================================================

# Directory for downloaded WAV files
export DOWNLOAD_DIR="/home/rpibroadcaster/wav"

# Maximum number of files to keep (0 = unlimited, not recommended)
export MAX_STORED_FILES=100

# File cleanup interval (seconds)
export CLEANUP_INTERVAL=300

# ============================================================
# Silence Carrier Configuration
# ============================================================

# Path to silence WAV file (will be created if it doesn't exist)
export SILENCE_FILE="/home/rpibroadcaster/wav/silence_carrier.wav"

# Duration of silence carrier in seconds
export SILENCE_SECS=1800

# ============================================================
# Security (Optional Whitelists)
# ============================================================

# Allowed S3 buckets (comma-separated, empty = allow all)
# Recommended: Set this to only your trusted buckets
export ALLOWED_S3_BUCKETS="my-audio-bucket,my-backup-bucket"

# Allowed URL domains (comma-separated, empty = allow all)
# Recommended: Set this to only your trusted CDN domains
export ALLOWED_URL_DOMAINS="cdn.example.com,backup.example.com"

# ============================================================
# Logging (Optional)
# ============================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
export LOG_LEVEL="INFO"

# Use structured JSON logging (true/false)
export STRUCTURED_LOGGING="false"
